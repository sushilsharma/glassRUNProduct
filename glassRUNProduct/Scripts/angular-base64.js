(function(c,b){c._arrayBufferToBase64=function(e){var d="";var f=new Uint8Array(e);var h=f.byteLength;for(var g=0;g<h;g++){d+=String.fromCharCode(f[g])}return c.btoa(d)};var a=c.angular.module("naif.base64",[]);a.directive("baseSixtyFourInput",["$window","$q",function(f,d){var k={onChange:"&",parser:"&"};var h=["onabort","onerror","onloadstart","onloadend","onprogress","onload"];for(var j=h.length-1;j>=0;j--){var g=h[j];k[g]="&"}return{restrict:"A",require:"?ngModel",scope:k,link:function(z,v,u,x){if(!x){return}x.$setViewValue(null);x.$setPristine();if(angular.isFunction(x.$setUntouched)){x.$setUntouched()}var y=[];var w=[];function l(A,E,D,B,C){D[A]=function(F){E()(F,D,B,y,w,C)}}function r(C,A,B){return function(E){var D=E.target.result;var F;B.base64=f._arrayBufferToBase64(D);if(u.parser){F=d.when(z.parser()(A,B))}else{F=d.when(B)}F.then(function(G){w.push(G);t()});if(u.onload){z.onload()(E,C,A,y,w,B)}}}function i(D,B,C){for(var E=h.length-1;E>=0;E--){var A=h[E];if(u[A]&&A!=="onload"){l(A,z[A],D,B,C)}}D.onload=r(D,B,C)}function t(){var A=u.multiple?w:w[0];x.$setViewValue(A);if(angular.isFunction(x.$validate)){x.$validate()}var B=angular.version.full.split(".");if(B[0]==="1"&&B[1]==="3"&&parseInt(B[2])>=4){var C=x.$viewValue;n(C);p(C);m(C);o(C);e(C)}}function s(){for(var C=y.length-1;C>=0;C--){var D=new f.FileReader();var A=y[C];var B={};B.filetype=A.type;B.filename=A.name;B.filesize=A.size;i(D,A,B);D.readAsArrayBuffer(A)}}function q(A){if(u.onChange){z.onChange()(A,y)}}v.on("change",function(A){if(!A.target.files.length){return}w=[];w=angular.copy(w);y=A.target.files;s();q(A)});function m(A){if(u.maxnum&&u.multiple&&A){var B=A.length<=parseInt(u.maxnum);x.$setValidity("maxnum",B)}return A}function o(A){if(u.minnum&&u.multiple&&A){var B=A.length>=parseInt(u.minnum);x.$setValidity("minnum",B)}return A}function n(D){var E=true;if(u.maxsize&&D){var C=parseFloat(u.maxsize)*1000;if(u.multiple){for(var B=0;B<D.length;B++){var A=D[B];if(A.filesize>C){E=false;break}}}else{E=D.filesize<=C}x.$setValidity("maxsize",E)}return D}function p(D){var E=true;var C=parseFloat(u.minsize)*1000;if(u.minsize&&D){if(u.multiple){for(var B=0;B<D.length;B++){var A=D[B];if(A.filesize<C){E=false;break}}}else{E=D.filesize>=C}x.$setValidity("minsize",E)}return D}function e(F){var G=true;var E,A,C;if(u.accept){A=u.accept.trim().replace(/[,\s]+/gi,"|").replace(/\./g,"\\.").replace(/\/\*/g,"/.*");E=new RegExp(A)}if(u.accept&&F){if(u.multiple){for(var D=0;D<F.length;D++){var B=F[D];C="."+B.filename.split(".").pop();G=E.test(B.filetype)||E.test(C);if(!G){break}}}else{C="."+F.filename.split(".").pop();G=E.test(F.filetype)||E.test(C)}x.$setValidity("accept",G)}return F}x.$parsers.push(m);x.$parsers.push(o);x.$parsers.push(n);x.$parsers.push(p);x.$parsers.push(e)}}}])})(window);
if(!window.console){console={log:function(){}}}var textAngular=angular.module("textAngular",["ngSanitize"]);textAngular.directive("textAngular",["$compile","$window","$document","$rootScope","$timeout","taFixChrome",function(k,c,g,b,f,d){console.log("Thank you for using textAngular! http://www.textangular.com");function h(l,a){for(var i in a){if(a[i]&&a[i].constructor&&a[i].constructor===Object){l[i]=l[i]||{};arguments.callee(l[i],a[i])}else{l[i]=a[i]}}return l}b.textAngularOpts=h({toolbar:[["h1","h2","h3","p","pre","quote"],["bold","italics","underline","ul","ol","redo","undo","clear"],["justifyLeft","justifyCenter","justifyRight"],["html","insertImage","insertLink","unlink"]],classes:{focussed:"focussed",toolbar:"btn-toolbar",toolbarGroup:"btn-group",toolbarButton:"btn btn-default",toolbarButtonActive:"active",textEditor:"form-control",htmlEditor:"form-control"}},b.textAngularOpts!=null?b.textAngularOpts:{});var j=function(i){i=i.toLowerCase();var a=g[0].queryCommandValue("formatBlock").toLowerCase();return a===i||a===i};b.textAngularTools=h({html:{display:"<button type='button' ng-click='action()' ng-class='displayActiveToolClass(active)'>Toggle HTML</button>",action:function(){var i,a=this;this.$parent.showHtml=!this.$parent.showHtml;if(this.$parent.showHtml){f(function(){return a.$parent.displayElements.html[0].focus()},100)}else{f(function(){return a.$parent.displayElements.text[0].focus()},100)}this.active=this.$parent.showHtml}},h1:{display:"<button type='button' ng-click='action()' ng-class='displayActiveToolClass(active)'>H1</button>",action:function(){return this.$parent.wrapSelection("formatBlock","<H1>")},activeState:function(){return j("h1")}},h2:{display:"<button type='button' ng-click='action()' ng-class='displayActiveToolClass(active)'>H2</button>",action:function(){return this.$parent.wrapSelection("formatBlock","<H2>")},activeState:function(){return j("h2")}},h3:{display:"<button type='button' ng-click='action()' ng-class='displayActiveToolClass(active)'>H3</button>",action:function(){return this.$parent.wrapSelection("formatBlock","<H3>")},activeState:function(){return j("h3")}},p:{display:"<button type='button' ng-click='action()' ng-class='displayActiveToolClass(active)'>P</button>",action:function(){return this.$parent.wrapSelection("formatBlock","<P>")},activeState:function(){return j("p")}},pre:{display:"<button type='button' ng-click='action()' ng-class='displayActiveToolClass(active)'>pre</button>",action:function(){return this.$parent.wrapSelection("formatBlock","<PRE>")},activeState:function(){return j("pre")}},ul:{display:"<button type='button' ng-click='action()' ng-class='displayActiveToolClass(active)'><i class='fa fa-list-ul'></i></button>",action:function(){return this.$parent.wrapSelection("insertUnorderedList",null)},activeState:function(){return g[0].queryCommandState("insertUnorderedList")}},ol:{display:"<button type='button' ng-click='action()' ng-class='displayActiveToolClass(active)'><i class='fa fa-list-ol'></i></button>",action:function(){return this.$parent.wrapSelection("insertOrderedList",null)},activeState:function(){return g[0].queryCommandState("insertOrderedList")}},quote:{display:"<button type='button' ng-click='action()' ng-class='displayActiveToolClass(active)'><i class='fa fa-quote-right'></i></button>",action:function(){return this.$parent.wrapSelection("formatBlock","<BLOCKQUOTE>")},activeState:function(){return j("blockquote")}},undo:{display:"<button type='button' ng-click='action()' ng-class='displayActiveToolClass(active)'><i class='fa fa-undo'></i></button>",action:function(){return this.$parent.wrapSelection("undo",null)}},redo:{display:"<button type='button' ng-click='action()' ng-class='displayActiveToolClass(active)'><i class='fa fa-repeat'></i></button>",action:function(){return this.$parent.wrapSelection("redo",null)}},bold:{display:"<button type='button' ng-click='action()' ng-class='displayActiveToolClass(active)'><i class='fa fa-bold'></i></button>",action:function(){return this.$parent.wrapSelection("bold",null)},activeState:function(){return g[0].queryCommandState("bold")}},justifyLeft:{display:"<button type='button' ng-click='action()' ng-class='displayActiveToolClass(active)'><i class='fa fa-align-left'></i></button>",action:function(){return this.$parent.wrapSelection("justifyLeft",null)},activeState:function(){return g[0].queryCommandState("justifyLeft")}},justifyRight:{display:"<button type='button' ng-click='action()' ng-class='displayActiveToolClass(active)'><i class='fa fa-align-right'></i></button>",action:function(){return this.$parent.wrapSelection("justifyRight",null)},activeState:function(){return g[0].queryCommandState("justifyRight")}},justifyCenter:{display:"<button type='button' ng-click='action()' ng-class='displayActiveToolClass(active)'><i class='fa fa-align-center'></i></button>",action:function(){return this.$parent.wrapSelection("justifyCenter",null)},activeState:function(){return g[0].queryCommandState("justifyCenter")}},italics:{display:"<button type='button' ng-click='action()' ng-class='displayActiveToolClass(active)'><i class='fa fa-italic'></i></button>",action:function(){return this.$parent.wrapSelection("italic",null)},activeState:function(){return g[0].queryCommandState("italic")}},underline:{display:"<button type='button' ng-click='action()' ng-class='displayActiveToolClass(active)'><i class='fa fa-underline'></i></button>",action:function(){return this.$parent.wrapSelection("underline",null)},activeState:function(){return g[0].queryCommandState("underline")}},clear:{display:"<button type='button' ng-click='action()' ng-class='displayActiveToolClass(active)'><i class='fa fa-ban'></i></button>",action:function(){return this.$parent.wrapSelection("removeFormat",null)}},insertImage:{display:"<button type='button' ng-click='action()' ng-class='displayActiveToolClass(active)'><i class='fa fa-picture-o'></i></button>",action:function(){var a;a=prompt("Please enter an image URL to insert","http://");if(a!==""){return this.$parent.wrapSelection("insertImage",a)}}},insertLink:{display:"<button type='button' ng-click='action()' ng-class='displayActiveToolClass(active)'><i class='fa fa-link'></i></button>",action:function(){var a;a=prompt("Please enter an URL to insert","http://");if(a!==""){return this.$parent.wrapSelection("createLink",a)}}},unlink:{display:"<button type='button' ng-click='action()' ng-class='displayActiveToolClass(active)'><i class='fa fa-unlink'></i></button>",action:function(){return this.$parent.wrapSelection("unlink",null)}}},b.textAngularTools!=null?b.textAngularTools:{});return{require:"ngModel",scope:{},restrict:"EA",link:function(l,w,A,z){var a,B,x,i,n,t;angular.extend(l,b.textAngularOpts,{wrapSelection:function(m,e){document.execCommand(m,false,e);if(m==="insertUnorderedList"||m==="insertOrderedList"){d(l.displayElements.text)}if(l.showHtml){l.displayElements.html[0].focus()}else{l.displayElements.text[0].focus()}l.updateSelectedStyles();if(!l.showHtml){l.updateTaBindtext()}},showHtml:false});if(!!A.taToolbar){l.toolbar=l.$eval(A.taToolbar)}if(!!A.taFocussedClass){l.classes.focussed=l.$eval(A.taFocussedClass)}if(!!A.taToolbarClass){l.classes.toolbar=A.taToolbarClass}if(!!A.taToolbarGroupClass){l.classes.toolbarGroup=A.taToolbarGroupClass}if(!!A.taToolbarButtonClass){l.classes.toolbarButton=A.taToolbarButtonClass}if(!!A.taToolbarActiveButtonClass){l.classes.toolbarButtonActive=A.taToolbarActiveButtonClass}if(!!A.taTextEditorClass){l.classes.textEditor=A.taTextEditorClass}if(!!A.taHtmlEditorClass){l.classes.htmlEditor=A.taHtmlEditorClass}l.displayElements={toolbar:angular.element("<div></div>"),forminput:angular.element("<input type='hidden' style='display: none;'>"),html:angular.element("<textarea ng-show='showHtml' ta-bind='html' ng-model='html' ></textarea>"),text:angular.element("<div contentEditable='true' ng-hide='showHtml' ta-bind='text' ng-model='text' ></div>")};w.append(l.displayElements.toolbar);w.append(l.displayElements.text);w.append(l.displayElements.html);if(!!A.name){l.displayElements.forminput.attr("name",A.name);w.append(l.displayElements.forminput)}k(l.displayElements.text)(l);k(l.displayElements.html)(l);w.addClass("ta-root");l.displayElements.toolbar.addClass("ta-toolbar "+l.classes.toolbar);l.displayElements.text.addClass("ta-text ta-editor "+l.classes.textEditor);l.displayElements.html.addClass("ta-html ta-editor "+l.classes.textEditor);w.on("focusin",function(){w.addClass(l.classes.focussed);f(function(){w.triggerHandler("focus")},0)});w.on("focusout",function(){f(function(){if(!(g[0].activeElement===l.displayElements.html[0])&&!(g[0].activeElement===l.displayElements.text[0])){w.removeClass(l.classes.focussed);f(function(){w.triggerHandler("blur")},0)}},0)});l.tools={};for(var D=0;D<l.toolbar.length;D++){a=l.toolbar[D];B=angular.element("<div></div>");B.addClass(l.classes.toolbarGroup);for(var q=0;q<a.length;q++){n=a[q];t=angular.element(b.textAngularTools[n].display);t.addClass(l.classes.toolbarButton);t.attr("unselectable","on");t.attr("ng-disabled","showHtml()");var C=angular.extend(l.$new(true),b.textAngularTools[n],{name:n,showHtml:function(){if(this.name!=="html"){return this.$parent.showHtml}return false},displayActiveToolClass:function(e){return e?this.$parent.classes.toolbarButtonActive:""}});l.tools[n]=C;B.append(k(t)(C))}l.displayElements.toolbar.append(B)}z.$render=function(){l.displayElements.forminput.val(z.$viewValue);if(z.$viewValue===undefined){return}if(!(g[0].activeElement===l.displayElements.html[0])&&!(g[0].activeElement===l.displayElements.text[0])){var e=z.$viewValue||"";l.text=e;l.html=e}};l.$watch("text",function(m,e){l.html=m;z.$setViewValue(m);l.displayElements.forminput.val(m)});l.$watch("html",function(m,e){l.text=m;z.$setViewValue(m);l.displayElements.forminput.val(m)});l.bUpdateSelectedStyles=false;l.updateSelectedStyles=function(){for(var o=0;o<l.toolbar.length;o++){var m=l.toolbar[o];for(var e=0;e<m.length;e++){n=m[e];if(l.tools[n].activeState!=null){l.tools[n].active=l.tools[n].activeState.apply(l)}}}if(this.bUpdateSelectedStyles){f(this.updateSelectedStyles,200)}};x=function(e){l.bUpdateSelectedStyles=true;l.$apply(function(){l.updateSelectedStyles()})};l.displayElements.html.on("keydown",x);l.displayElements.text.on("keydown",x);i=function(e){l.bUpdateSelectedStyles=false};l.displayElements.html.on("keyup",i);l.displayElements.text.on("keyup",i);mouseup=function(e){l.$apply(function(){l.updateSelectedStyles()})};l.displayElements.html.on("mouseup",mouseup);l.displayElements.text.on("mouseup",mouseup)}}}]).directive("taBind",["$sanitize","$document","taFixChrome",function(c,a,b){return{require:"ngModel",scope:{taBind:"@"},link:function(d,f,e,g){var j=f[0].tagName.toLowerCase()!=="textarea"&&f[0].tagName.toLowerCase()!=="input"&&f.attr("contenteditable")!==undefined;var h=function(){var i=b(angular.element("<div>").append(f.html())).html();if(d.taBind==="html"&&j){i=i.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")}return i};d.$parent["updateTaBind"+d.taBind]=function(){var k=h();var i=g.$parsers;g.$parsers=[];g.$oldViewValue=k;g.$setViewValue(k);g.$parsers=i};if(j){f.on("keyup",function(i){g.$setViewValue(h())})}g.$parsers.push(function(i){if(g.$oldViewValue===undefined){g.$oldViewValue=i}try{c(i)}catch(k){return g.$oldViewValue}g.$oldViewValue=i;return i});g.$render=function(){if(g.$viewValue===undefined){return}if(a[0].activeElement!==f[0]){var i=g.$viewValue||"";g.$oldViewValue=i;if(d.taBind==="text"){f.html(i);f.find("a").on("click",function(k){k.preventDefault();return false})}else{if(j||f[0].tagName.toLowerCase()!=="textarea"&&f[0].tagName.toLowerCase()!=="input"){f.html(i.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"))}else{f.val(i)}}}else{if(!j){f.val(i)}}}}}}]).factory("taFixChrome",function(){var a=function(g){var c=angular.element(g).find("span");for(var f=0;f<c.length;f++){var b=angular.element(c[f]);if(b.attr("style")&&b.attr("style").match(/line-height: 1.428571429;|color: inherit; line-height: 1.1;/i)){if(b.next().length>0&&b.next()[0].tagName==="BR"){b.next().remove()}b.replaceWith(b.html())}}var d=g.html().replace(/style="[^"]*?(line-height: 1.428571429;|color: inherit; line-height: 1.1;)[^"]*"/gi,"");g.html(d);return g};return a});
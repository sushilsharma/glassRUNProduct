function RSAKeyPair(b,a,c){this.e=biFromHex(b);this.d=biFromHex(a);this.m=biFromHex(c);this.digitSize=2*biHighIndex(this.m)+2;this.chunkSize=this.digitSize-11;this.radix=16;this.barrett=new BarrettMu(this.m)}function twoDigit(a){return(a<10?"0":"")+String(a)}function encryptedString(n,r){if(n.chunkSize>n.digitSize-11){return"Error"}var c=new Array();var t=r.length;var h=0;while(h<t){c[h]=r.charCodeAt(h);h++}var d=c.length;var q="";var l,m,f;for(h=0;h<d;h+=n.chunkSize){f=new BigInt();l=0;var v;var o=(h+n.chunkSize)>d?d%n.chunkSize:n.chunkSize;var e=new Array();for(v=0;v<o;v++){e[v]=c[h+o-1-v]}e[o]=0;var p=Math.max(8,n.digitSize-3-o);for(v=0;v<p;v++){e[o+1+v]=Math.floor(Math.random()*254)+1}e[n.digitSize-2]=2;e[n.digitSize-1]=0;for(m=0;m<n.digitSize;++l){f.digits[l]=e[m++];f.digits[l]+=e[m++]<<8}var g=n.barrett.powMod(f,n.e);var u=n.radix==16?biToHex(g):biToString(g,n.radix);q+=u+" "}return q.substring(0,q.length-1)}function decryptedString(f,h){var c=h.split(" ");var g="";var d,e,b;for(d=0;d<c.length;++d){var a;if(f.radix==16){a=biFromHex(c[d])}else{a=biFromString(c[d],f.radix)}b=f.barrett.powMod(a,f.d);for(e=0;e<=biHighIndex(b);++e){g+=String.fromCharCode(b.digits[e]&255,b.digits[e]>>8)}}if(g.charCodeAt(g.length-1)==0){g=g.substring(0,g.length-1)}return g}function base64encode(j){var b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var a=new Array(-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1);var h,f,g;var c,d,e;g=j.length;f=0;h="";while(f<g){c=j.charCodeAt(f++)&255;if(f==g){h+=b.charAt(c>>2);h+=b.charAt((c&3)<<4);h+="==";break}d=j.charCodeAt(f++);if(f==g){h+=b.charAt(c>>2);h+=b.charAt(((c&3)<<4)|((d&240)>>4));h+=b.charAt((d&15)<<2);h+="=";break}e=j.charCodeAt(f++);h+=b.charAt(c>>2);h+=b.charAt(((c&3)<<4)|((d&240)>>4));h+=b.charAt(((d&15)<<2)|((e&192)>>6));h+=b.charAt(e&63)}return h};
/* RateIt | v1.0.22 / 05/27/2014 | https://rateit.codeplex.com/license
    http://rateit.codeplex.com | Twitter: @gjunge
*/
(function(a){function b(d){var g=d.originalEvent.changedTouches,f=g[0],c="",e;switch(d.type){case"touchmove":c="mousemove";break;case"touchend":c="mouseup";break;default:return}e=document.createEvent("MouseEvent");e.initMouseEvent(c,!0,!0,window,1,f.screenX,f.screenY,f.clientX,f.clientY,!1,!1,!1,!1,0,null);f.target.dispatchEvent(e);d.preventDefault()}a.rateit={aria:{resetLabel:"reset rating",ratingLabel:"rating"}};a.fn.rateit=function(g,j){var c=1,l={},h="init",k=function(e){return e.charAt(0).toUpperCase()+e.substr(1)},d;if(this.length===0){return this}if(d=a.type(g),d=="object"||g===undefined||g===null){l=a.extend({},a.fn.rateit.defaults,g)}else{if(d=="string"&&g!=="reset"&&j===undefined){return this.data("rateit"+k(g))}d=="string"&&(h="setvalue")}return this.each(function(){var m=a(this),o=function(p,w){if(w!=null){var f="aria-value"+(p=="value"?"now":p),v=m.find(".rateit-range");v.attr(f)!=undefined&&v.attr(f,w)}return arguments[0]="rateit"+k(p),m.data.apply(m,arguments)},z,C,B,r,i,q,x,u,D,t,e;if(g=="reset"){z=o("init");for(C in z){m.data(C,z[C])}o("backingfld")&&(r=a(o("backingfld")),r.val(o("value")),r.trigger("change"),r[0].min&&(r[0].min=o("min")),r[0].max&&(r[0].max=o("max")),r[0].step&&(r[0].step=o("step")));m.trigger("reset")}if(m.hasClass("rateit")||m.addClass("rateit"),B=m.css("direction")!="rtl",h=="setvalue"){if(!o("init")){throw"Can't set value before init"}g!="readonly"||j!=!0||o("readonly")||(m.find(".rateit-range").unbind(),o("wired",!1));g=="value"&&(j=j==null?o("min"):Math.max(o("min"),Math.min(o("max"),j)));o("backingfld")&&(r=a(o("backingfld")),g=="value"&&r.val(j),g=="min"&&r[0].min&&(r[0].min=j),g=="max"&&r[0].max&&(r[0].max=j),g=="step"&&r[0].step&&(r[0].step=j));o(g,j)}o("init")||(o("min",isNaN(o("min"))?l.min:o("min")),o("max",isNaN(o("max"))?l.max:o("max")),o("step",o("step")||l.step),o("readonly",o("readonly")!==undefined?o("readonly"):l.readonly),o("resetable",o("resetable")!==undefined?o("resetable"):l.resetable),o("backingfld",o("backingfld")||l.backingfld),o("starwidth",o("starwidth")||l.starwidth),o("starheight",o("starheight")||l.starheight),o("value",Math.max(o("min"),Math.min(o("max"),isNaN(o("value"))?isNaN(l.value)?l.min:l.value:o("value")))),o("ispreset",o("ispreset")!==undefined?o("ispreset"):l.ispreset),o("backingfld")&&(r=a(o("backingfld")).hide(),(r.attr("disabled")||r.attr("readonly"))&&o("readonly",!0),r[0].nodeName=="INPUT"&&(r[0].type=="range"||r[0].type=="text")&&(o("min",parseInt(r.attr("min"))||o("min")),o("max",parseInt(r.attr("max"))||o("max")),o("step",parseInt(r.attr("step"))||o("step"))),r[0].nodeName=="SELECT"&&r[0].options.length>1?(o("min",isNaN(o("min"))?Number(r[0].options[0].value):o("min")),o("max",Number(r[0].options[r[0].length-1].value)),o("step",Number(r[0].options[1].value)-Number(r[0].options[0].value)),i=r.find("option[selected]"),i.length==1&&o("value",i.val())):o("value",r.val())),q=m[0].nodeName=="DIV"?"div":"span",c++,x='<button id="rateit-reset-{{index}}" type="button" data-role="none" class="rateit-reset" aria-label="'+a.rateit.aria.resetLabel+'" aria-controls="rateit-range-{{index}}"></button><{{element}} id="rateit-range-{{index}}" class="rateit-range" tabindex="0" role="slider" aria-label="'+a.rateit.aria.ratingLabel+'" aria-owns="rateit-reset-{{index}}" aria-valuemin="'+o("min")+'" aria-valuemax="'+o("max")+'" aria-valuenow="'+o("value")+'"><{{element}} class="rateit-selected" style="height:'+o("starheight")+'px"></{{element}}><{{element}} class="rateit-hover" style="height:'+o("starheight")+'px"></{{element}}></{{element}}>',m.append(x.replace(/{{index}}/gi,c).replace(/{{element}}/gi,q)),B||(m.find(".rateit-reset").css("float","right"),m.find(".rateit-selected").addClass("rateit-selected-rtl"),m.find(".rateit-hover").addClass("rateit-hover-rtl")),o("init",JSON.parse(JSON.stringify(m.data()))));m.find(".rateit-selected, .rateit-hover").height(o("starheight"));u=m.find(".rateit-range");u.width(o("starwidth")*(o("max")-o("min"))).height(o("starheight"));D="rateit-preset"+(B?"":"-rtl");o("ispreset")?m.find(".rateit-selected").addClass(D):m.find(".rateit-selected").removeClass(D);o("value")!=null&&(t=(o("value")-o("min"))*o("starwidth"),m.find(".rateit-selected").width(t));e=m.find(".rateit-reset");e.data("wired")!==!0&&e.bind("click",function(p){p.preventDefault();e.blur();var f=a.Event("beforereset");if(m.trigger(f),f.isDefaultPrevented()){return !1}m.rateit("value",null);m.trigger("reset")}).data("wired",!0);var A=function(v,f){var w=f.changedTouches?f.changedTouches[0].pageX:f.pageX,p=w-a(v).offset().left;return B||(p=u.width()-p),p>u.width()&&(p=u.width()),p<0&&(p=0),t=Math.ceil(p/o("starwidth")*(1/o("step")))},s=function(p){var w=p*o("starwidth")*o("step"),v=u.find(".rateit-hover"),f;v.data("width")!=w&&(u.find(".rateit-selected").hide(),v.width(w).show().data("width",w),f=[p*o("step")+o("min")],m.trigger("hover",f).trigger("over",f))},n=function(p){var f=a.Event("beforerated");return(m.trigger(f,[p]),f.isDefaultPrevented())?!1:(o("value",p),o("backingfld")&&a(o("backingfld")).val(p).trigger("change"),o("ispreset")&&(u.find(".rateit-selected").removeClass(D),o("ispreset",!1)),u.find(".rateit-hover").hide(),u.find(".rateit-selected").width(p*o("starwidth")-o("min")*o("starwidth")).show(),m.trigger("hover",[null]).trigger("over",[null]).trigger("rated",[p]),!0)};o("readonly")?e.hide():(o("resetable")||e.hide(),o("wired")||(u.bind("touchmove touchend",b),u.mousemove(function(f){var p=A(this,f);s(p)}),u.mouseleave(function(){u.find(".rateit-hover").hide().width(0).data("width","");m.trigger("hover",[null]).trigger("over",[null]);u.find(".rateit-selected").show()}),u.mouseup(function(p){var v=A(this,p),f=v*o("step")+o("min");n(f);u.blur()}),u.keyup(function(f){(f.which==38||f.which==(B?39:37))&&n(Math.min(o("value")+o("step"),o("max")));(f.which==40||f.which==(B?37:39))&&n(Math.max(o("value")-o("step"),o("min")))}),o("wired",!0)),o("resetable")&&e.show());u.attr("aria-readonly",o("readonly"))})};a.fn.rateit.defaults={min:0,max:5,step:0.5,starwidth:16,starheight:16,readonly:!1,resetable:!0,ispreset:!1};a(function(){a("div.rateit, span.rateit").rateit()})})(jQuery);
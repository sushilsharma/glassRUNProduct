

<ion-view>
    <ion-content class="main-content">
        <div class="pageview">
            <div class="header">
                <h2>{{Action}} <strong>{{resData.res_AddPolicy_RoleAccess}}</strong></h2>
            </div>

            <div class="row">
                <div class="col-md-12">

                    <div class="nav-tabs2">
                        <ul class="nav nav-tabs" ng-class="{'nav-stacked': vertical, 'nav-justified': justified}">
                            <li class="active" ng-class="{'active': ViewTab}">
                                <a ng-click="ViewForm()" class="">
                                    <tab-heading>
                                        <i class="fa fa-eye"></i>{{resData.res_AddPolicy_View}}</tab-heading>
                                </a>
                            </li>
                            <li class="" ng-class="{'active': AddTab}">
                                <a ng-click="AddForm()">
                                    <tab-heading>
                                        <i class="fa fa-plus"></i>{{resData.res_AddPolicy_Add}}</tab-heading>
                                </a>
                            </li>
                        </ul>
                        <div class="tab-content">

                            <div class="tab-pane" ng-class="{'active': AddTab}">
                                <div class="panel-content">
                                    <div class="row">
                                        <div class="formcontrols form-horizontal ng-pristine ng-valid">

                                            <div class="fullwidth">
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label class="col-sm-3 control-label">{{resData.res_AddPolicy_RoleName}}</label>
                                                        <div class="col-sm-9">
                                                            <select class="form-control" ng-change="LoadProfileAccordingToRole(RoleField.RoleMasterId)" ng-model="RoleField.RoleMasterId" ng-options="obj.RoleMasterId as obj.RoleName for obj in RolesDetails">
                                                                <option value="Select">{{resData.res_AddPolicy_Select}}
                                                            </select>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="fullwidth">

                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label class="col-sm-3 control-label">{{resData.res_AddPolicy_PolicyName}}</label>
                                                        <div class="col-sm-9">
                                                            <input class="form-control form-white" ng-model="RoleField.PolicyName" type="text" placeholder="Policy Name">
                                                        </div>
                                                    </div>
                                                </div>

                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label class="col-sm-3 control-label">{{resData.res_AddPolicy_Users}}</label>
                                                        <div class="col-sm-9">
                                                            <div class="uk-grid uk-padding-bottom-remove uk-padding-top-remove" data-uk-grid-margin="">
                                                                <div ng-dropdown-multiselect="1" events="myEventListeners" options="ProfileList" selected-model="ProfileSelectedList" checkboxes="true" extra-settings="ProfileSettings"></div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>


                                            <div class="col-md-12">
                                                <div class="fullwidth">
                                                    <label class="control-label">{{resData.res_AddPolicy_Setrolepermissiontoaccessreadwriteanddelete}}</label>
                                                </div>

                                                <table class="table tablegrid table-hover">
                                                    <thead>
                                                        <tr>
                                                            <th>{{resData.res_AddPolicy_PageName}}</th>
                                                            <th>{{resData.res_AddPolicy_View}}</th>
                                                            <th>{{resData.res_AddPolicy_Edit}}</th>
                                                            <th>{{resData.res_AddPolicy_Add}}</th>
                                                            <th>{{resData.res_AddPolicy_Delete}}</th>
                                                            <th>{{resData.res_AddPolicy_Action}}</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr ng-repeat="page in PageDetails">

                                                            <td>{{page.PageName}}</td>
                                                            <td><input class="form-white" type="checkbox" ng-disabled="page.IsDisabledView" ng-model="page.ViewAccess" ng-change="toggleSelection(page.PageId,page.ViewAccess,'1',0)"></td>
                                                            <td><input class="form-white" type="checkbox" ng-disabled="page.IsDisabledEdit" ng-model="page.EditAccess" ng-change="toggleSelection(page.PageId,page.EditAccess,'2',0)"></td>
                                                            <td><input class="form-white" type="checkbox" ng-disabled="page.IsDisabledAdd" ng-model="page.AddAccess" ng-change="toggleSelection(page.PageId,page.AddAccess,'3',0)"></td>
                                                            <td><input class="form-white" type="checkbox" ng-disabled="page.IsDisabledDelete" ng-model="page.DeleteAccess" ng-change="toggleSelection(page.PageId,page.DeleteAccess,'4',0)"></td>
                                                            <td><a ng-click="OpenPageControlAccessModalpopup(page.PageId)" ng-class="{'disablebutton': page.ViewAccess === false && page.EditAccess === false && page.AddAccess === false && page.DeleteAccess === false }" class="controllink">{{resData.res_AddPolicy_AddControlLevelAccess}}</a></td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>

                                            <div class="ActionButtons">
                                                <div class="clearbtn">
                                                    <button type="button" ng-click="Clear()" class="btn btn-default">{{resData.res_AddPolicy_Clear}}</button>
                                                </div>
                                                <div class="successbtn">
                                                    <button type="button" ng-click="Save()" class="btn btn-success">{{resData.res_AddPolicy_Save}}</button>
                                                </div>
                                            </div>

                                        </div>

                                    </div>
                                </div>
                            </div>
                            <div class="tab-pane active" ng-class="{'active': ViewTab}">
                                <div class="panel-content">
                                    <div class="row">
                                        <div class="formcontrols form-horizontal ng-pristine ng-valid">
                                            <div class="col-md-12">
                                                <div kendo-grid="Grid" k-options="ViewRoleAccessGrid" k-rebind="ViewRoleAccessGrid"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>


                </div>
            </div>

            <script id="templates/ControlLevelAccess.html" type="text/ng-template">
                <ion-modal-view class="bgcolorheaderandfooter" style="min-height:500px !important">
                    <ion-header-bar class="bar bar-header bar-positive">
                        <h1 class="title">Control Level Access</h1>
                        <button class="button button-clear button-primary" ng-click="ClosePageControlAccessModalpopup()"><i class="fa fa-times"></i></button>
                    </ion-header-bar>
                    <ion-content scroll="false">
                        <div class="scrollview">
                            <div class="col-md-12 padding">
                                <div class="fullwidth">
                                    <label class="control-label"> Set role permission to access read, write and delete. </label>
                                </div>

                                <div class="pageverticalconatiner" ng-repeat="object in PageControls">
                                    <div class="labelheading">
                                        <h2> {{object.ObjectName}}</h2>
                                    </div>

                                    <table class="table tablegrid table-hover">
                                        <thead>
                                            <tr>
                                                <th>Field Name</th>
                                                <th>View</th>
                                                <th>Edit</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr ng-repeat="pageControl in object.ObjectPropertiesList">
                                                <td>{{pageControl.PropertyName}}</td>
                                                <td><input class="form-white" ng-change="SetFieldAction(object.ObjectId,pageControl.ObjectPropertiesId,1,pageControl.ViewAccess)" ng-model="pageControl.ViewAccess" type="checkbox" /></td>
                                                <td><input class="form-white" ng-change="SetFieldAction(object.ObjectId,pageControl.ObjectPropertiesId,2,pageControl.EditAccess)" ng-model="pageControl.EditAccess" type="checkbox" /></td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>


                            </div>
                        </div>
                    </ion-content>
                    <ion-footer-bar align-title="left" class="bar-assertive">

                        <div style="float:left;width:100%">
                            <div class="buttons rightbtn resetbutton" ng-click="SavePageControlAccess()">
                                <button class="button btn btn-success">Save</button>
                            </div>
                            <div class="buttons rightbtn" ng-click="ResetPageControlAccess()">
                                <button class="button btn btn-default">Reset</button>
                            </div>

                        </div>
                    </ion-footer-bar>
                </ion-modal-view>
            </script>
        </div>
    </ion-content>
</ion-view>
